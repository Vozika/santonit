TSB Subscription
v1.38beta

Скрипт позволяет вести базу данных подписчиков (имя, электронный адрес, время, ip, почтовый сервер),
делать рассылку писем, отправлять уведомительное письмо при подписании и отписании от рассылки (свои шаблоны писем),
оповещать администратора о новых подписчиках, экспортировать  базу подписчиков в почтовые менеджеры.

- Установка:
* обновление с предыдущей до этой версии не требуется.

********************************************************
Первое , что хочу у вас попросить - не убирайте копирайты!
Это единственный способ отблагодарить меня за скрипт (помимо вебмани ;) Z393453519599)).
Спасибо и надеюсь на ваше взаимопонимание!
********************************************************

1. Распакуйте все вайлы в директорию на вашем веб-узле (readme.txt можно не закачивать).
2. Измените права доступа на папку, к воторой находится скрипт, на 777.
   На папку files, letters и всем шаблонами в этой папке также необходимы права доступа 777.
3. запустите setup.php.
4. поместите этот код для вызова формы подписки:

	<?php include("путь к скрипту/show_form.php"); ?>
      например:
      <?php include("tsbsub/show_form.php"); ?>

5. Для проверки и уведомления о новых подписчиках всавьте следущий код в код вашей страницы:

	<script src="путь к скрипту/check.php"></script>
      например:
      <script src="tsbsub/check.php"></script>

6. Для вызова панели администратора наберите в браузере <путь к скрипту>/admin.php

7. Для подтверждения рассылки пользователь должен кликнуть по ссылке вида:
   <путь к скрипту>/write.php?id=[id]&validate=[code]

8. Для отписания от рассылки пользователь должен кликнуть по ссылке вида:
   <путь к скрипту>/write.php?id=[id]&unsub=[code]

9. Пример потверждающего письма: (его нужно скопировать в окно "шаблон письма" раздела)
	Все примеры писем сохранены по умолчанию.

10. Коды для писем: (в письме используются с квадратными скобками)

[name] - имя подписчика
[mail] - почта подписчика
[sendername] - Ваше имя или имя организации
[id] - персональный номер подписчика
[code] - персональный код активации/дизактивации рассылки
[url] - адрес Вашего сайта
[folder] - папка с этим скриптом

11. Если во время тестировании скрипта локально при подписке выскакивает ошибка, сделайте следущее:
    открываем файд write.php и ищем код: (строчки 60-62)
              if (!getmxrr($emailhost,$mxhosts)) $mailserver=1;
              else $mailserver=$mxhosts[(count($mxhosts)-1)];
              //$mailserver=0;
    и закавычиваем первые две и расковычиваем последнюю, вот так:
              //if (!getmxrr($emailhost,$mxhosts)) $mailserver=1;
              //else $mailserver=$mxhosts[(count($mxhosts)-1)];
              $mailserver=0;
    т.е. при добавлении email не будет проверяться на существование.
    Эта ошибка возникает т.к. в WIn системе отсутсвует эта функция. На сервере все будет ок (если он конечно под unix).
    Не забудте все исправить при закачке на сервер.

12. При добавлении файла к письму приоритет имеет путь до файла на сервере. В случае,
    если будут указаны и путь до файла на сервере и путь для загрузки с диска - файл с диска
    загрузится, но прикреплен к письму будет файл относительно локального пути.

- Обновление (если требуется):
1. замените все файлы на сервере файлами из дистрибутива
2. выставите права доступа (chmod) папки со скриптом (по умолчанию tsbsub) как 777
3. ОБЯЗАТЕЛЬНО! запустите update.php для обновления базы данных

поддерживаемые программы для экспорта списка рассылки:
TheBat! - создание adress list (plain text)
Outlook Express - создание scv файла с разделителями-запятыми
Becky! - текстовый файл
Mazilla Mail - .ldif файл

Подробная история здесь (http://tsb.mimozaf.ru/index.php?menu=history)

v. 1.38b  - 09.02.05 (21.7)
[+] - добавлена возможность рассылки в html (подтверждение, рассылка и отказ от рассылки)
[+] - добавлен возможность добавления файла к письму (спасибо Cruiser)
[+] - теперь письмо отсылается не из шаблона, а из формы. т.е. сохранять перед отправкой не надо.
[+] - активные коды и html разметка
[*] - ошибка JS в меню администратора
[*] - при выходе не разрывалась сессия. исправлено.
[*] - исправлена ошибка сбрасывания редактируемого шаблона

v. 1.37.5b - 09.12.04 (21.7)
[+] - добавлена функция пакетного удаления несуществующих адресов.
[*] - исправлена ошибка пакетного удаления. (спасибо Cruiser)
[*] - теперь письма отсылаются только потвержденным пользователям.
[*] - исправлена проверка данных, вводимых пользователями

v. 1.37.4b - 29.09.04 (20.3)
[*] - исправлена ошибка установки при register_globals=off (спасибо Незнакомец)

v. 1.37.3b - 21.09.04 (19.9)
[+] - первые тесты рассылки писем из скрипта
[+] - добавлены шаблоны для писем подписки, отписания от рассылки и самого письма рассылки.
[+] - добавлен дизайн формы подписки ;)
[+] - добавлена возможность выбора кодировки писем
[+] - добавлена возможность отключения запроса имени подписчика
[*] - переработан код write.php - теперь запросы имеют божеский вид ;)
[+] - теперь, при отписании, на почту отправляется письмо с уведомлением


TSB Scripts, 2003-2005гг.
tsbscripts@hotmail.com
http://tsb.mimozaf.ru